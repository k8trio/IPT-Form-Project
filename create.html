<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Create CV</title>
    <link rel="stylesheet" href="styles.css">
</head>
<body>
    <div class="container">
        <header>
            <h1>Create Your CV</h1>
            <a href="index.html" class="back-btn">Back to Home</a>
        </header>

        <form id="cvForm" class="cv-form">
            <div class="color-selector">
                <h3>Choose Your CV Theme</h3>
                <div class="color-options">
                    <label class="color-option">
                        <input type="radio" name="color_theme" value="#1a3a52" checked>
                        <span class="color-preview" style="background: #1a3a52;"></span>
                        <span class="color-name">Navy Blue</span>
                    </label>
                    <label class="color-option">
                        <input type="radio" name="color_theme" value="#2d4a3e">
                        <span class="color-preview" style="background: #2d4a3e;"></span>
                        <span class="color-name">Forest Green</span>
                    </label>
                    <label class="color-option">
                        <input type="radio" name="color_theme" value="#3d3d3d">
                        <span class="color-preview" style="background: #3d3d3d;"></span>
                        <span class="color-name">Charcoal Grey</span>
                    </label>
                </div>
            </div>

            <div class="form-section">
                <h2>Personal Information</h2>
                <div class="form-grid">
                    <div class="form-group full-width">
                        <label>Profile Photo</label>
                        <input type="file" id="profileImage" accept="image/*" class="file-input">
                        <div id="imagePreview"></div>
                    </div>
                    <div class="form-group">
                        <label>Full Name *</label>
                        <input type="text" id="fullName" required>
                    </div>
                    <div class="form-group">
                        <label>Email *</label>
                        <input type="email" id="email" required>
                    </div>
                    <div class="form-group">
                        <label>Phone</label>
                        <input type="tel" id="phone">
                    </div>
                    <div class="form-group">
                        <label>Website</label>
                        <input type="url" id="website" placeholder="https://">
                    </div>
                    <div class="form-group full-width">
                        <label>Address</label>
                        <input type="text" id="address">
                    </div>
                    <div class="form-group full-width">
                        <label>About Me</label>
                        <textarea id="aboutMe" rows="4"></textarea>
                    </div>
                </div>
            </div>

            <div class="form-section">
                <h2>Education</h2>
                <div id="educationContainer">
                    <div class="dynamic-entry">
                        <div class="form-grid">
                            <div class="form-group">
                                <label>Degree</label>
                                <input type="text" class="degree">
                            </div>
                            <div class="form-group">
                                <label>Institution</label>
                                <input type="text" class="institution">
                            </div>
                            <div class="form-group">
                                <label>Start Year</label>
                                <input type="text" class="edu_start_year">
                            </div>
                            <div class="form-group">
                                <label>End Year</label>
                                <input type="text" class="edu_end_year">
                            </div>
                        </div>
                    </div>
                </div>
                <button type="button" class="add-more-btn" onclick="addEducation()">Add More Education</button>
            </div>

            <div class="form-section">
                <h2>Work Experience</h2>
                <div id="experienceContainer">
                    <div class="dynamic-entry">
                        <div class="form-grid">
                            <div class="form-group">
                                <label>Job Title</label>
                                <input type="text" class="job_title">
                            </div>
                            <div class="form-group">
                                <label>Company</label>
                                <input type="text" class="company">
                            </div>
                            <div class="form-group">
                                <label>Start Year</label>
                                <input type="text" class="exp_start_year">
                            </div>
                            <div class="form-group">
                                <label>End Year</label>
                                <input type="text" class="exp_end_year">
                            </div>
                            <div class="form-group full-width">
                                <label>Description</label>
                                <textarea class="description" rows="3"></textarea>
                            </div>
                        </div>
                    </div>
                </div>
                <button type="button" class="add-more-btn" onclick="addExperience()">Add More Experience</button>
            </div>

            <div class="form-section">
                <h2>Skills</h2>
                <div id="skillsContainer">
                    <div class="dynamic-entry skill-entry">
                        <div class="form-grid">
                            <div class="form-group">
                                <label>Skill Name</label>
                                <input type="text" class="skill_name">
                            </div>
                            <div class="form-group">
                                <label>Proficiency Level (1-7)</label>
                                <input type="number" class="skill_level" min="1" max="7" value="5">
                            </div>
                        </div>
                    </div>
                </div>
                <button type="button" class="add-more-btn" onclick="addSkill()">Add More Skills</button>
            </div>

            <div class="form-actions">
                <button type="submit" class="save-btn">Save CV</button>
            </div>
        </form>
    </div>

    <script>
        let imageData = '';

        document.getElementById('profileImage').addEventListener('change', function(e) {
            const file = e.target.files[0];
            if (file) {
                const reader = new FileReader();
                reader.onload = function(event) {
                    imageData = event.target.result;
                    document.getElementById('imagePreview').innerHTML = 
                        '<img src="' + imageData + '" style="max-width: 150px; margin-top: 10px; border-radius: 8px;">';
                };
                reader.readAsDataURL(file);
            }
        });

        function addEducation() {
            const container = document.getElementById('educationContainer');
            const entry = document.createElement('div');
            entry.className = 'dynamic-entry';
            entry.innerHTML = `
                <div class="form-grid">
                    <div class="form-group">
                        <label>Degree</label>
                        <input type="text" class="degree">
                    </div>
                    <div class="form-group">
                        <label>Institution</label>
                        <input type="text" class="institution">
                    </div>
                    <div class="form-group">
                        <label>Start Year</label>
                        <input type="text" class="edu_start_year">
                    </div>
                    <div class="form-group">
                        <label>End Year</label>
                        <input type="text" class="edu_end_year">
                    </div>
                </div>
                <button type="button" class="remove-btn" onclick="this.parentElement.remove()">Remove</button>
            `;
            container.appendChild(entry);
        }

        function addExperience() {
            const container = document.getElementById('experienceContainer');
            const entry = document.createElement('div');
            entry.className = 'dynamic-entry';
            entry.innerHTML = `
                <div class="form-grid">
                    <div class="form-group">
                        <label>Job Title</label>
                        <input type="text" class="job_title">
                    </div>
                    <div class="form-group">
                        <label>Company</label>
                        <input type="text" class="company">
                    </div>
                    <div class="form-group">
                        <label>Start Year</label>
                        <input type="text" class="exp_start_year">
                    </div>
                    <div class="form-group">
                        <label>End Year</label>
                        <input type="text" class="exp_end_year">
                    </div>
                    <div class="form-group full-width">
                        <label>Description</label>
                        <textarea class="description" rows="3"></textarea>
                    </div>
                </div>
                <button type="button" class="remove-btn" onclick="this.parentElement.remove()">Remove</button>
            `;
            container.appendChild(entry);
        }

        function addSkill() {
            const container = document.getElementById('skillsContainer');
            const entry = document.createElement('div');
            entry.className = 'dynamic-entry skill-entry';
            entry.innerHTML = `
                <div class="form-grid">
                    <div class="form-group">
                        <label>Skill Name</label>
                        <input type="text" class="skill_name">
                    </div>
                    <div class="form-group">
                        <label>Proficiency Level (1-7)</label>
                        <input type="number" class="skill_level" min="1" max="7" value="5">
                    </div>
                </div>
                <button type="button" class="remove-btn" onclick="this.parentElement.remove()">Remove</button>
            `;
            container.appendChild(entry);
        }

        document.getElementById('cvForm').addEventListener('submit', function(e) {
            e.preventDefault();
            
            const cvData = {
                fullName: document.getElementById('fullName').value,
                email: document.getElementById('email').value,
                phone: document.getElementById('phone').value,
                website: document.getElementById('website').value,
                address: document.getElementById('address').value,
                aboutMe: document.getElementById('aboutMe').value,
                colorTheme: document.querySelector('input[name="color_theme"]:checked').value,
                profileImage: imageData,
                education: [],
                experience: [],
                skills: []
            };

            document.querySelectorAll('#educationContainer .dynamic-entry').forEach(entry => {
                const degree = entry.querySelector('.degree').value;
                const institution = entry.querySelector('.institution').value;
                const startYear = entry.querySelector('.edu_start_year').value;
                const endYear = entry.querySelector('.edu_end_year').value;
                
                if (degree || institution) {
                    cvData.education.push({ degree, institution, startYear, endYear });
                }
            });

            document.querySelectorAll('#experienceContainer .dynamic-entry').forEach(entry => {
                const jobTitle = entry.querySelector('.job_title').value;
                const company = entry.querySelector('.company').value;
                const startYear = entry.querySelector('.exp_start_year').value;
                const endYear = entry.querySelector('.exp_end_year').value;
                const description = entry.querySelector('.description').value;
                
                if (jobTitle || company) {
                    cvData.experience.push({ jobTitle, company, startYear, endYear, description });
                }
            });

            document.querySelectorAll('#skillsContainer .dynamic-entry').forEach(entry => {
                const skillName = entry.querySelector('.skill_name').value;
                const skillLevel = entry.querySelector('.skill_level').value;
                
                if (skillName) {
                    cvData.skills.push({ skillName, skillLevel });
                }
            });
            //J: delete or specify this part
            let cvList = JSON.parse(localStorage.getItem('cvList') || '[]');
            cvData.id = cvList.length > 0 ? Math.max(...cvList.map(cv => cv.id)) + 1 : 1;
            cvList.push(cvData);
            localStorage.setItem('cvList', JSON.stringify(cvList));
            //until line 304
            alert('CV saved successfully!');
            window.location.href = 'index.html';
        });
    </script>
</body>
</html>
